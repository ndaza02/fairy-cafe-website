<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Fairy Cafe Bulawayo</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-yellow': '#1d691b',
                        'text-dark': '#2B2B2B',
                        'text-gray': '#7c7c7c',
                        'bg-light': '#F2F2F2',
                        'bg-dark': '#111',
                    },
                    fontFamily: {
                        'poppins': ['Poppins', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .option-card.active {
            border-color: #1d691b;
            background-color: rgba(29, 105, 27, 0.05);
        }
    </style>
</head>

<body class="bg-bg-light min-h-screen text-text-dark">

    <nav class="p-6 md:px-16 flex justify-between items-center bg-white border-b border-gray-100">
        <a href="menu.html"
            class="flex items-center gap-2 text-sm font-medium hover:text-primary-yellow transition-colors group">
            <i data-lucide="arrow-left" class="w-4 h-4 group-hover:-translate-x-1 transition-transform"></i>
            Back to Menu
        </a>
        <div class="text-2xl font-bold italic">Fairy Cafe<span class="text-primary-yellow">.</span></div>
        <div class="w-24"></div> <!-- Spacer for balance -->
    </nav>

    <main class="py-12 px-6 md:px-16 max-w-[1200px] mx-auto">
        <h1 class="text-4xl font-bold mb-10">Complete Your Order</h1>

        <div class="grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-12">

            <!-- Checkout Form -->
            <div class="space-y-8">

                <!-- Order Type Section -->
                <section class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-50">
                    <h3 class="text-xl font-bold mb-6 flex items-center gap-3">
                        <i data-lucide="shopping-bag" class="text-primary-yellow"></i>
                        Order Method
                    </h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div id="type-delivery"
                            class="option-card active p-6 rounded-2xl border-2 border-gray-100 cursor-pointer hover:border-primary-yellow/30 transition-all text-center">
                            <i data-lucide="truck" class="w-8 h-8 mx-auto mb-3 text-primary-yellow"></i>
                            <span class="font-bold block">Delivery</span>
                            <span class="text-xs text-text-gray">To your doorstep</span>
                        </div>
                        <div id="type-pickup"
                            class="option-card p-6 rounded-2xl border-2 border-gray-100 cursor-pointer hover:border-primary-yellow/30 transition-all text-center">
                            <i data-lucide="package" class="w-8 h-8 mx-auto mb-3 text-text-gray"></i>
                            <span class="font-bold block">Store Pickup</span>
                            <span class="text-xs text-text-gray">Collect at 168 Mugabe Way</span>
                        </div>
                    </div>
                </section>

                <!-- Personal Info Section -->
                <section class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-50">
                    <h3 class="text-xl font-bold mb-6 flex items-center gap-3">
                        <i data-lucide="user" class="text-primary-yellow"></i>
                        Details
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-xs font-bold text-text-gray uppercase tracking-wider mb-2">Full
                                Name</label>
                            <input type="text" placeholder="John Doe"
                                class="w-full px-5 py-3 rounded-xl border border-gray-100 outline-none focus:border-primary-yellow bg-gray-50/30">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-text-gray uppercase tracking-wider mb-2">Phone
                                Number</label>
                            <input type="tel" placeholder="+263 ..."
                                class="w-full px-5 py-3 rounded-xl border border-gray-100 outline-none focus:border-primary-yellow bg-gray-50/30">
                        </div>
                        <div class="md:col-span-2" id="delivery-address-container">
                            <label class="block text-xs font-bold text-text-gray uppercase tracking-wider mb-2">Delivery
                                Address</label>
                            <textarea placeholder="Your address in Bulawayo..." rows="3"
                                class="w-full px-5 py-3 rounded-xl border border-gray-100 outline-none focus:border-primary-yellow bg-gray-50/30"></textarea>
                        </div>
                    </div>
                </section>

                <!-- Payment Section (Static for MVP) -->
                <section class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-50">
                    <h3 class="text-xl font-bold mb-6 flex items-center gap-3">
                        <i data-lucide="credit-card" class="text-primary-yellow"></i>
                        Payment Method
                    </h3>
                    <div
                        class="p-6 rounded-2xl border-2 border-primary-yellow bg-primary-yellow/5 flex items-center gap-4">
                        <i data-lucide="banknote" class="w-6 h-6 text-primary-yellow"></i>
                        <div>
                            <span class="font-bold block">Cash on Delivery / Pickup</span>
                            <span class="text-xs text-text-gray">Pay when you receive your meal</span>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Order Summary -->
            <aside>
                <div class="sticky top-24 bg-white p-8 rounded-[2.5rem] shadow-xl border border-gray-100">
                    <h3 class="text-xl font-bold mb-6 pb-4 border-b border-gray-100">Order Summary</h3>

                    <div id="checkout-items" class="space-y-4 mb-8 max-h-[400px] overflow-y-auto pr-2">
                        <!-- Items injected via JS -->
                    </div>

                    <div class="space-y-3 pt-6 border-t border-gray-100">
                        <div class="flex justify-between text-text-gray">
                            <span>Subtotal</span>
                            <span id="subtotal">$0.00</span>
                        </div>
                        <div class="flex justify-between text-text-gray" id="delivery-fee-row">
                            <span>Delivery Fee</span>
                            <span id="delivery-fee">$2.00</span>
                        </div>
                        <div class="flex justify-between text-xl font-bold text-text-dark pt-3">
                            <span>Total</span>
                            <span id="final-total">$0.00</span>
                        </div>
                    </div>

                    <button id="place-order-btn"
                        class="w-full mt-10 py-5 bg-primary-yellow text-white rounded-full font-bold text-lg hover:bg-text-dark transition-all transform hover:-translate-y-1 shadow-2xl active:scale-95">
                        Place Order
                    </button>
                    <p class="text-center text-xs text-text-gray mt-4">Estimated time: 25-40 mins</p>
                </div>
            </aside>
        </div>
    </main>

    <!-- Success Modal -->
    <div id="success-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center opacity-0 invisible transition-all duration-500">
        <div
            class="bg-white p-12 rounded-[3rem] max-w-md w-full text-center transform scale-90 transition-all duration-500">
            <div
                class="w-24 h-24 bg-primary-yellow/10 rounded-full flex items-center justify-center mx-auto mb-8 text-primary-yellow">
                <i data-lucide="check-circle-2" class="w-12 h-12"></i>
            </div>
            <h2 class="text-3xl font-bold mb-4">Order Placed!</h2>
            <p class="text-text-gray mb-10 leading-relaxed">Your magic meal is being prepared. We'll contact you shortly
                at the provided number.</p>
            <a href="index.html"
                class="block w-full py-4 bg-text-dark text-white rounded-full font-bold hover:bg-primary-yellow transition-colors">
                Back to Home
            </a>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // LocalStorage Cart Handling
        let cart = JSON.parse(localStorage.getItem('fairyCart')) || [];

        function updateSummary() {
            const container = document.getElementById('checkout-items');
            container.innerHTML = '';

            let subtotalVal = 0;

            if (cart.length === 0) {
                container.innerHTML = '<p class="text-center text-text-gray py-8 italic">Your cart is empty</p>';
                document.getElementById('place-order-btn').disabled = true;
                document.getElementById('place-order-btn').classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                cart.forEach((item, index) => {
                    const priceNum = parseFloat(item.price.replace('$', ''));
                    subtotalVal += priceNum * item.quantity;

                    container.innerHTML += `
                        <div class="flex justify-between items-center gap-4">
                            <div class="flex-grow">
                                <h4 class="font-bold text-sm">${item.name}</h4>
                                <span class="text-xs text-text-gray">${item.quantity} x ${item.price}</span>
                            </div>
                            <span class="font-bold">$${(priceNum * item.quantity).toFixed(2)}</span>
                        </div>
                    `;
                });
            }

            const deliveryFee = document.getElementById('type-delivery').classList.contains('active') ? 2.00 : 0.00;

            document.getElementById('subtotal').innerText = `$${subtotalVal.toFixed(2)}`;
            document.getElementById('delivery-fee').innerText = `$${deliveryFee.toFixed(2)}`;
            document.getElementById('final-total').innerText = `$${(subtotalVal + deliveryFee).toFixed(2)}`;

            if (deliveryFee === 0) {
                document.getElementById('delivery-fee-row').classList.add('opacity-40');
            } else {
                document.getElementById('delivery-fee-row').classList.remove('opacity-40');
            }
        }

        // Toggle Logic
        const delBtn = document.getElementById('type-delivery');
        const pickBtn = document.getElementById('type-pickup');
        const addressContainer = document.getElementById('delivery-address-container');

        delBtn.addEventListener('click', () => {
            delBtn.classList.add('active');
            pickBtn.classList.remove('active');
            delBtn.querySelector('i').classList.replace('text-text-gray', 'text-primary-yellow');
            pickBtn.querySelector('i').classList.replace('text-primary-yellow', 'text-text-gray');
            addressContainer.style.display = 'block';
            updateSummary();
        });

        pickBtn.addEventListener('click', () => {
            pickBtn.classList.add('active');
            delBtn.classList.remove('active');
            pickBtn.querySelector('i').classList.replace('text-text-gray', 'text-primary-yellow');
            delBtn.querySelector('i').classList.replace('text-primary-yellow', 'text-text-gray');
            addressContainer.style.display = 'none';
            updateSummary();
        });

        // Place Order
        document.getElementById('place-order-btn').addEventListener('click', () => {
            const modal = document.getElementById('success-modal');
            const inner = modal.querySelector('div');

            modal.classList.remove('invisible');
            gsap.to(modal, { opacity: 1, duration: 0.5 });
            gsap.to(inner, { scale: 1, duration: 0.5, ease: "back.out(1.7)" });

            localStorage.removeItem('fairyCart');
        });

        updateSummary();
    </script>
</body>

</html>